"use strict";(self.webpackChunkcreate_project_docs=self.webpackChunkcreate_project_docs||[]).push([[4986],{5766:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"api-specification/BackendAPI","title":"Backend API","description":"Audio Transcription Server","source":"@site/docs/api-specification/BackendAPI.md","sourceDirName":"api-specification","slug":"/api-specification/BackendAPI","permalink":"/project-002-highlighting/docs/api-specification/BackendAPI","draft":false,"unlisted":false,"editUrl":"https://github.com/Capstone-Projects-2025-Fall/project-002-highlighting/edit/main/documentation/docs/api-specification/BackendAPI.md","tags":[],"version":"current","lastUpdatedBy":"Jude","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"API Specification","permalink":"/project-002-highlighting/docs/category/api-specification"},"next":{"title":"Frontend API","permalink":"/project-002-highlighting/docs/api-specification/Frontend"}}');var r=i(74848),s=i(28453);const l={},o="Backend API",d={},c=[{value:"Audio Transcription Server",id:"audio-transcription-server",level:2},{value:"Overview",id:"overview",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Next Tile Prediction (Local LLM + Vector)",id:"next-tile-prediction-local-llm--vector",level:2},{value:"<code>/api/nextTilePred</code> (POST)",id:"apinexttilepred-post",level:3},{value:"Expected Input",id:"expected-input",level:4},{value:"Output",id:"output",level:4},{value:"Example Request",id:"example-request",level:4},{value:"Example Response",id:"example-response",level:4},{value:"API Block: Next Tile Prediction (POST)",id:"api-block-next-tile-prediction-post",level:3},{value:"Next Tile Prediction (Local LLM, Customizable TopN)",id:"next-tile-prediction-local-llm-customizable-topn",level:2},{value:"<code>/api/nextTilePredLocal</code> (POST)",id:"apinexttilepredlocal-post",level:3},{value:"Expected Input",id:"expected-input-1",level:4},{value:"Output",id:"output-1",level:4},{value:"Example Request",id:"example-request-1",level:4},{value:"Example Response",id:"example-response-1",level:4},{value:"API Block: Next Tile Prediction Local (POST)",id:"api-block-next-tile-prediction-local-post",level:3},{value:"WebSocket Events",id:"websocket-events",level:2},{value:"Client \u2192 Server",id:"client--server",level:3},{value:"Server \u2192 Client",id:"server--client",level:3},{value:"Example Client Usage (JavaScript)",id:"example-client-usage-javascript",level:2},{value:"Example: Finding Relevant Words",id:"example-finding-relevant-words",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"backend-api",children:"Backend API"})}),"\n",(0,r.jsx)(n.h2,{id:"audio-transcription-server",children:"Audio Transcription Server"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The Audio Transcription Server enables real-time speech-to-text and context-aware word/tile suggestions for clients (such as web applications). It leverages:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Express"})," for HTTP and API endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Socket.io"})," for real-time audio streaming"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"FFmpeg"})," for audio format conversion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Whisper model"})," for speech transcription"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local LLM (DistilGPT2)"})," and ",(0,r.jsx)(n.strong,{children:"vector search (MiniLM)"})," for word prediction"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Supabase"})," (optional) for event logging"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Variable"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Required?"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SUPABASE_URL"})}),(0,r.jsx)(n.td,{children:"Supabase project REST API URL"}),(0,r.jsx)(n.td,{children:"Optional"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"https://xyz.supabase.co"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SUPABASE_KEY"})}),(0,r.jsx)(n.td,{children:"Supabase API Key"}),(0,r.jsx)(n.td,{children:"Optional"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"service-role-key"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SUPABASE_LOG_TABLE"})}),(0,r.jsx)(n.td,{children:"Supabase table for logging events"}),(0,r.jsx)(n.td,{children:"Optional"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"transcript_highlights"})})]})]})]}),"\n",(0,r.jsx)(n.h1,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,r.jsx)(n.h2,{id:"next-tile-prediction-local-llm--vector",children:"Next Tile Prediction (Local LLM + Vector)"}),"\n",(0,r.jsxs)(n.h3,{id:"apinexttilepred-post",children:[(0,r.jsx)(n.code,{children:"/api/nextTilePred"})," (POST)"]}),"\n",(0,r.jsx)(n.p,{children:"Predicts the next set of tiles (words) based on transcript and/or pressed tiles using a local LLM and vector search."}),"\n",(0,r.jsx)(n.h4,{id:"expected-input",children:"Expected Input"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"transcript"})," (optional): Full or partial transcript text (string)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pressedTiles"})," (optional): Array of recently pressed tile strings"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"output",children:"Output"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"predictedTiles"}),": Array of up to 10 suggested next tiles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"status"}),": ",(0,r.jsx)(n.code,{children:"success"})," or ",(0,r.jsx)(n.code,{children:"error"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pressedTiles"}),": Array of tiles considered"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"context"}),": Text context used for prediction"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-request",children:"Example Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5000/api/nextTilePred \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "transcript": "I would like to eat pizza",\n    "pressedTiles": ["eat", "pizza"]\n  }\'\n'})}),"\n",(0,r.jsx)(n.h4,{id:"example-response",children:"Example Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "predictedTiles": ["drink", "water", "bread", "yes", "no", "please", "thankyou", "more", "help", "stop"],\n  "status": "success",\n  "context": "I would like to eat pizza",\n  "pressedTiles": ["eat", "pizza"]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"api-block-next-tile-prediction-post",children:"API Block: Next Tile Prediction (POST)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-api",children:'{\n    "title": "Next Tile Prediction",\n    "description": "Predict the next set of tiles/words based on transcript and/or pressed tiles using local LLM and vector search.",\n    "method": "POST",\n    "baseUrl": "http://localhost:5000",\n    "endpoint": "/api/nextTilePred",\n    "headers": [\n        {\n            "key": "Content-Type",\n            "value": "application/json",\n            "required": true\n        }\n    ],\n    "queryParams": [],\n    "pathParams": [],\n    "bodyType": "json",\n    "requestBody": "{\\n  \\"transcript\\": \\"I would like to eat pizza\\",\\n  \\"pressedTiles\\": [\\"eat\\", \\"pizza\\"]\\n}",\n    "responses": {\n        "200": {\n            "description": "Success",\n            "body": "{\\n  \\"predictedTiles\\": [\\"drink\\", \\"water\\", \\"bread\\", \\"yes\\", \\"no\\", \\"please\\", \\"thankyou\\", \\"more\\", \\"help\\", \\"stop\\"],\\n  \\"status\\": \\"success\\",\\n  \\"context\\": \\"I would like to eat pizza\\",\\n  \\"pressedTiles\\": [\\"eat\\", \\"pizza\\"]\\n}"\n        },\n        "400": {\n            "description": "Validation error",\n            "body": "{\\n  \\"error\\": \\"Either transcript or pressedTiles (or both) must be provided\\",\\n  \\"status\\": \\"error\\"\\n}"\n        },\n        "500": {\n            "description": "Internal error",\n            "body": "{\\n  \\"error\\": \\"Internal server error\\",\\n  \\"status\\": \\"error\\"\\n}"\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"next-tile-prediction-local-llm-customizable-topn",children:"Next Tile Prediction (Local LLM, Customizable TopN)"}),"\n",(0,r.jsxs)(n.h3,{id:"apinexttilepredlocal-post",children:[(0,r.jsx)(n.code,{children:"/api/nextTilePredLocal"})," (POST)"]}),"\n",(0,r.jsxs)(n.p,{children:["Similar to ",(0,r.jsx)(n.code,{children:"/api/nextTilePred"}),", but allows specifying the number of predictions (",(0,r.jsx)(n.code,{children:"topN"}),")."]}),"\n",(0,r.jsx)(n.h4,{id:"expected-input-1",children:"Expected Input"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"transcript"})," (optional): Full or partial transcript text (string)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pressedTiles"})," (optional): Array of recently pressed tile strings"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"topN"})," (optional): Number of top tiles to return (default: 10)"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"output-1",children:"Output"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"predictedTiles"}),": Array of up to ",(0,r.jsx)(n.code,{children:"topN"})," suggested next tiles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"status"}),": ",(0,r.jsx)(n.code,{children:"success"})," or ",(0,r.jsx)(n.code,{children:"error"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pressedTiles"}),": Array of tiles considered"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"context"}),": Text context used for prediction"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"example-request-1",children:"Example Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:5000/api/nextTilePredLocal \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "transcript": "I am thirsty",\n    "pressedTiles": ["drink"],\n    "topN": 5\n  }\'\n'})}),"\n",(0,r.jsx)(n.h4,{id:"example-response-1",children:"Example Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "predictedTiles": ["water", "milk", "juice", "yes", "no"],\n  "status": "success",\n  "context": "I am thirsty",\n  "pressedTiles": ["drink"]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"api-block-next-tile-prediction-local-post",children:"API Block: Next Tile Prediction Local (POST)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-api",children:'{\n    "title": "Next Tile Prediction Local",\n    "description": "Predict the next set of tiles/words based on transcript and/or pressed tiles using local LLM and vector search, allowing custom topN.",\n    "method": "POST",\n    "baseUrl": "http://localhost:5000",\n    "endpoint": "/api/nextTilePredLocal",\n    "headers": [\n        {\n            "key": "Content-Type",\n            "value": "application/json",\n            "required": true\n        }\n    ],\n    "queryParams": [],\n    "pathParams": [],\n    "bodyType": "json",\n    "requestBody": "{\\n  \\"transcript\\": \\"I am thirsty\\",\\n  \\"pressedTiles\\": [\\"drink\\"],\\n  \\"topN\\": 5\\n}",\n    "responses": {\n        "200": {\n            "description": "Success",\n            "body": "{\\n  \\"predictedTiles\\": [\\"water\\", \\"milk\\", \\"juice\\", \\"yes\\", \\"no\\"],\\n  \\"status\\": \\"success\\",\\n  \\"context\\": \\"I am thirsty\\",\\n  \\"pressedTiles\\": [\\"drink\\"]\\n}"\n        },\n        "400": {\n            "description": "Validation error",\n            "body": "{\\n  \\"error\\": \\"Either transcript or pressedTiles (or both) must be provided\\",\\n  \\"status\\": \\"error\\"\\n}"\n        },\n        "500": {\n            "description": "Internal error",\n            "body": "{\\n  \\"error\\": \\"Internal server error\\",\\n  \\"status\\": \\"error\\"\\n}"\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h1,{id:"websocket-real-time-audio-transcription",children:"WebSocket (Real-time) Audio Transcription"}),"\n",(0,r.jsx)(n.p,{children:"Clients can connect to the server via Socket.io and stream audio in real time. The server transcribes audio and emits results back."}),"\n",(0,r.jsx)(n.h2,{id:"websocket-events",children:"WebSocket Events"}),"\n",(0,r.jsx)(n.h3,{id:"client--server",children:"Client \u2192 Server"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"audio-chunk"}),": Send a chunk of raw WebM audio data."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"server--client",children:"Server \u2192 Client"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"transcript"}),": Emits the latest transcribed text."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example-client-usage-javascript",children:"Example Client Usage (JavaScript)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import io from "socket.io-client";\n\nconst socket = io("http://localhost:5000");\n\n// ... obtain an audio chunk (arraybuffer) ...\nsocket.emit("audio-chunk", audioBuffer);\n\n// Listen for transcription results\nsocket.on("transcript", (text) => {\n  console.log("Transcribed:", text);\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"example-finding-relevant-words",children:"Example: Finding Relevant Words"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const context = "I would like to drink water";\nconst words = ["yes", "no", "drink", "water", "bread", "hello"];\nconst relevant = findRelevantWords(context, words);\n// Output: ["drink", "water", "yes", "no", ...]\n'})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var t=i(96540);const r={},s=t.createContext(r);function l(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);